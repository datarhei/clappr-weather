{"version":3,"file":"weather.min.js","sources":["../node_modules/style-inject/dist/style-inject.es.js","../src/main.js"],"sourcesContent":["function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import { Events, UIContainerPlugin, template, $ } from '@clappr/core';\nimport weatherHTML from './public/weather.html';\nimport './public/style.scss';\nimport icon from './public/icon.svg';\nimport icon_disabled from './public/icon_disabled.svg';\n\nconst DEFAULT_URL = null;\nconst DEFAULT_REFRESH = 5;\nconst DEFAULT_REWRITE = null;\nconst DEFAULT_UNITS = 'metric';\n\nexport default class Weather extends UIContainerPlugin {\n\tget name() {\n\t\treturn 'weather';\n\t}\n\n\tget template() {\n\t\treturn template(weatherHTML);\n\t}\n\n\tget attributes() {\n\t\treturn {\n\t\t\t'class': this.name,\n\t\t\t'data-weather': ''\n\t\t};\n\t}\n\n\tconstructor(container) {\n\t\tsuper(container);\n\t\tthis.configure();\n\t}\n\n\tbindEvents() {\n\t\tthis.listenTo(this.container, Events.CONTAINER_PLAY, () => {\n\t\t\tthis.show();\n\t\t});\n\t\tthis.listenTo(this.container, Events.CONTAINER_STOP, () => {\n\t\t\tthis.hide();\n\t\t});\n\t\tthis.listenTo(this.container, Events.CONTAINER_OPTIONS_CHANGE, this.configure);\n\t}\n\n\tconfigure() {\n\t\tthis.hasData = false;\n\n\t\tthis.url = DEFAULT_URL;\n\t\tthis.rewrite = DEFAULT_REWRITE;\n\t\tthis.refresh = DEFAULT_REFRESH;\n\t\tthis.units = DEFAULT_UNITS;\n\t\tthis.data = null;\n\n\t\tconst cfg = this.options.weatherConfig || {};\n\n\t\tif ('rewrite' in cfg) {\n\t\t\tif (typeof cfg.rewrite === 'function') {\n\t\t\t\tthis.rewrite = cfg.rewrite;\n\t\t\t}\n\t\t}\n\n\t\tif ('url' in cfg) {\n\t\t\tthis.url = cfg.url;\n\t\t}\n\n\t\tif ('refresh' in cfg) {\n\t\t\tthis.refresh = parseInt(cfg.refresh);\n\t\t}\n\n\t\tif ('units' in cfg) {\n\t\t\tif (cfg.units === 'imperial') {\n\t\t\t\tthis.units = 'imperial';\n\t\t\t}\n\t\t}\n\n\t\tthis.load();\n\t\tthis.render();\n\t}\n\n\tdestroy() {\n\t\tthis.$el.remove();\n\t}\n\n\trender() {\n\t\tthis.$el.hide();\n\n\t\tthis.container.$el.append(this.$el);\n\n\t\treturn this;\n\t}\n\n\tdisable() {\n\t\tthis.enabled = false;\n\n\t\tthis.hide();\n\t}\n\n\tenable() {\n\t\t//this.bindEvents();\n\t\tthis.enabled = true;\n\n\t\tthis.show();\n\t\tthis.load();\n\t}\n\n\tupdate(data) {\n\t\tif (data === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.hasData = true;\n\n\t\tlet temperature = undefined;\n\t\tlet precipitation = undefined;\n\t\tlet winddirection = undefined;\n\t\tlet windspeed = undefined;\n\t\tlet pressure = undefined;\n\t\tlet humidity = undefined;\n\t\tlet timestamp = undefined;\n\n\t\tif (this.units === 'imperial') {\n\t\t\ttemperature = this._convertToFahrenheit(data.temperature_c).toFixed(1) + ' 째F';\n\t\t\twinddirection = data.winddirection.toFixed(0) + '째 ' + this._getHeading(data.winddirection);\n\t\t\twindspeed = this._convertToMPH(data.windspeed_ms).toFixed(1) + ' mph';\n\t\t}\n\t\telse {\n\t\t\ttemperature = data.temperature_c.toFixed(1) + ' 째C';\n\t\t\twinddirection = data.winddirection.toFixed(0) + '째 ' + this._getHeading(data.winddirection);\n\t\t\twindspeed = data.windspeed_ms.toFixed(1) + ' m/s';\n\t\t}\n\n\t\tprecipitation = {\n\t\t\tvalue: ((data.precipitation.mode === 'none') ? '0' : data.precipitation.value_mm.toFixed(1)) + ' mm',\n\t\t\tmode: data.precipitation.mode\n\t\t};\n\n\t\tpressure = data.pressure_hpa.toFixed(2) + ' hpa';\n\t\thumidity = data.humidity.toFixed(0) + '%';\n\n\t\tthis.$el.html(this.template({\n\t\t\ttemperature: temperature,\n\t\t\tprecipitation: precipitation,\n\t\t\twinddirection: winddirection,\n\t\t\twindspeed: windspeed,\n\t\t\tpressure: pressure,\n\t\t\thumidity: humidity,\n\t\t\ttimestamp: timestamp,\n\t\t}));\n\t}\n\n\t_convertToFahrenheit(_value) {\n\t\treturn (_value * 1.8) + 32;\n\t}\n\n\t_convertToMPH(_value) {\n\t\treturn (_value / 1.609344 * 1000 / 3600);\n\t}\n\n\t_getHeading(_direction) {\n\t\tif (_direction < 0 || _direction > 360) {\n\t\t\treturn '--';\n\t\t}\n\n\t\tconst directions = 'N NNE NE ENE E ESE SE SSE S SSW SW WSW W WNW NW NNW'.split(' ');\n\n\t\tlet direction = 0;\n\t\tconst step = Math.floor(360 / directions.length);\n\t\tlet i = Math.floor(step / 2);\n\n\t\tif (_direction <= i || _direction >= 360 - i) {\n\t\t\treturn 'N';\n\t\t}\n\n\t\twhile (i <= _direction) {\n\t\t\tdirection++;\n\t\t\ti += step;\n\t\t}\n\n\t\treturn directions[direction];\n\t}\n\n\tshow() {\n\t\tif (this.enabled == true && this.hasData == true) {\n\t\t\t$('.clappr-watermark[data-watermark]').css('transition', 'top .4s ease-out');\n\t\t\t$('.clappr-watermark[data-watermark-top-left]').css('top', '50px');\n\t\t\t$('.clappr-watermark[data-watermark-top-right]').css('top', '50px');\n\t\t\tthis.$el.show();\n\t\t\tthis.$el.css('opacity', 1);\n\t\t}\n\n\t\treturn;\n\t}\n\n\thide() {\n\t\tthis.$el.css('opacity', 0);\n\t\tthis.$el.hide();\n\t\t$('.clappr-watermark[data-watermark]').css('transition', 'top .4s ease-out');\n\t\t$('.clappr-watermark[data-watermark-top-left]').css('top', '10px');\n\t\t$('.clappr-watermark[data-watermark-top-right]').css('top', '10px');\n\t}\n\n\tload() {\n\t\tif (!this.url || this.enabled === false) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet self = this;\n\n\t\tlet r = new XMLHttpRequest();\n\t\tlet url = this.url + (this.url.indexOf('?') !== -1 ? '&' : '?') + Date.now();\n\n\t\tr.open('GET', url);\n\t\tr.onload = function() {\n\t\t\tif (r.readyState === r.DONE) {\n\t\t\t\tif (r.status === 200) {\n\t\t\t\t\tlet text = r.responseText;\n\n\t\t\t\t\tlet data = null;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tdata = JSON.parse(text);\n\t\t\t\t\t}\n\t\t\t\t\tcatch (error) {\n\t\t\t\t\t\tdata = text;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (self.rewrite !== null) {\n\t\t\t\t\t\tdata = self.rewrite(data);\n\t\t\t\t\t}\n\n\t\t\t\t\tself.update(data);\n\t\t\t\t}\n\n\t\t\t\tif (self.refresh > 0) {\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tself.load();\n\t\t\t\t\t}, self.refresh * 1000);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tr.send();\n\t}\n\n\t// PluginControl interface\n\tpluginControl() {\n\t\tlet self = this;\n\n\t\tif (this.hasData === false) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn {\n\t\t\ticon: function() {\n\t\t\t\tif (self.enabled === true) {\n\t\t\t\t\treturn icon;\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn icon_disabled;\n\t\t\t\t}\n\t\t\t},\n\t\t\tname: function(lang = 'en') {\n\t\t\t\tlet name = 'Weather';\n\n\t\t\t\tswitch (lang) {\n\t\t\t\tcase 'de': name = 'Wetter'; break;\n\t\t\t\t}\n\n\t\t\t\treturn name;\n\t\t\t},\n\t\t\ttoggle: function() {\n\t\t\t\tif (self.enabled === true) {\n\t\t\t\t\tself.disable();\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tself.enable();\n\t\t\t\t}\n\n\t\t\t\treturn self.enabled;\n\t\t\t},\n\t\t\ttoggled: function() {\n\t\t\t\treturn self.enabled;\n\t\t\t}\n\t\t};\n\t}\n}\n"],"names":["css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","container","configure","template","this","name","listenTo","Events","CONTAINER_PLAY","_this2","show","CONTAINER_STOP","hide","CONTAINER_OPTIONS_CHANGE","hasData","url","rewrite","refresh","units","data","cfg","options","weatherConfig","parseInt","load","render","$el","remove","append","enabled","precipitation","pressure","humidity","temperature","undefined","winddirection","windspeed","_convertToFahrenheit","temperature_c","toFixed","_getHeading","_convertToMPH","windspeed_ms","value","mode","value_mm","pressure_hpa","html","timestamp","_value","_direction","directions","split","direction","step","Math","floor","length","i","$","self","r","XMLHttpRequest","indexOf","Date","now","open","onload","readyState","DONE","status","text","responseText","JSON","parse","error","update","setTimeout","send","icon","lang","toggle","disable","enable","toggled","UIContainerPlugin"],"mappings":"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"}