<!DOCTYPE HTML>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<script type="text/javascript" charset="utf-8" src="https://cdn.jsdelivr.net/npm/clappr@latest/dist/clappr.min.js"></script>
	<script type="text/javascript" charset="utf-8" src="../dist/weather.js"></script>
	<title>clappr-weather-plugin Test Page</title>
	<script type="text/javascript" charset="utf-8">
	window.onload = function() {
		var player = new Clappr.Player({
			source: 'https://ch-fra-n8.livespotting.com/vpu/qvciam2t/nsav1jnq_720.m3u8',
			parentId: '#player',

			plugins: [Weather],

			weatherConfig: {
				url: 'http://127.0.0.1:8080/data/weather.json',
				rewrite: function(data) {
					return data;
					var d = {
						"windspeed_ms": data.wind.speed,
						"winddirection": data.wind.deg,
						"temperature_c": data.main.temp,
						"humidity": data.main.humidity,
						"pressure_hpa": data.main.pressure,
						"precipitation": {
							"value_mm": 0.0,
							"mode": "none",
						},
						"timestamp": data.dt
					};

					if ('rain' in data) {
						d.precipitation.value_mm = data.rain.rain_1h;
						d.precipitation.mode = "rain";
					}
					else if ('snow' in data) {
						d.precipitation.value_mm = data.snow.snow_1h;
						d.precipitation.mode = "snow";
					}

					return d;
				},
				refresh: 10,
				units: 'imperial'
			},

			width: 640, height: 360,
			hideMediaControl: false,
			autoPlay: false
		});
	}
	</script>
</head>
<body>
	<div align="center">
		<div id="player"></div>
	</div>
</body>
</html>
